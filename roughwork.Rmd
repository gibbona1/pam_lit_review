---
title: "Passive Acoustic Monitoring Lit Review"
output: html_notebook
---

##Dataset size by year

```{r}
library(ggplot2)
library(maps)
library(dplyr)

df <- read.csv("tagged_literature.csv")
#df$Year <- as.factor(df$Year)

df |>
  tidyr::drop_na(Dataset_GB) |> 
  #filter(Year >= 2008) |>
  ggplot(aes(Year, Dataset_GB)) + 
  geom_point() + 
  scale_y_log10() +
  geom_smooth(method="lm", color = "dodgerblue")
```

```{r}
# Sample data
#coords <- c("-0.356251N,12.940863E;-0.078775N,15.127076E", "-0.078775N,15.1270777E")

# Function to convert coordinates to numeric values
convert_to_numeric <- function(coord_string) {
  # Split the string by comma
  parts <- strsplit(coord_string, ",")[[1]]
  #remove leading or trailing space
  
  # Extract latitude and longitude, handle direction
  lat <- as.numeric(gsub("[A-Z]", "", parts[1]))
  lon <- as.numeric(gsub("[A-Z]", "", parts[2]))
  
  # Check direction for latitude
  if (grepl("S", parts[1])) {
    lat <- -lat
  }
  
  # Check direction for longitude
  if (grepl("W", parts[2])) {
    lon <- -lon
  }
  
  return(c(lat, lon))
}

process_all_coords <- function(coords_string) {
  all_coords <- do.call(rbind, lapply(coords_string, function(x) {
    # Split by semicolon if present
    
    coord_list <- strsplit(x, ";")[[1]]
    
    if(is.null(coord_list) || length(coord_list) == 0)
      return(NA)
    
    #print(coord_list)
    # Convert each coordinate pair to numeric
    numeric_coords <- t(sapply(coord_list, convert_to_numeric))
    
    return(numeric_coords)
  }))
  
  return(all_coords)
}

# Convert all coordinates
latlong_df <- as.data.frame(process_all_coords(df$latlong))
colnames(latlong_df) <- c("lat", "long")

latlong_df <- na.omit(latlong_df)
```


```{r}
# Create the world map
world <- map_data("world")

# Plotting
ggplot() +
  # Add world map
  geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
  # Add points for different tags
  geom_point(data = latlong_df, aes(x = long, y = lat, shape = "1"), size = 3) +
  # Set coordinate system to map projection
  coord_fixed(ratio = 1) +
  # Add labels and title
  labs(title = "Global Distribution of Species",
       x = "Longitude",
       y = "Latitude") +
  # Adjust legend
  #scale_shape_manual(values = c(1, 2, 3, 4, 5), 
  #                   name = "Species",
  #                   breaks = c("Bats", "Non-flying mammals", "Birds", "Anurans", "Invertebrates"),
  #                   labels = c("Bats", "Non-flying mammals", "Birds", "Anurans", "Invertebrates")) +
  # Theme settings
  theme_minimal() +
  theme(panel.grid.major = element_line(color = "grey80"),
        panel.grid.minor = element_blank(),
        axis.text.x = element_text(angle = 0, hjust = 0.5),
        legend.position = "right")
```
```{r}
# Convert 'NA' to R's NA
df$Prog..language[df$Prog..language == "NA"] <- NA

# Split languages where there are multiple
df_lang <- df %>%
  mutate(ProgLanguage = strsplit(as.character(Prog..language), ", ")) %>%
  tidyr::unnest(ProgLanguage)

# Count occurrences per year
count_data <- df_lang %>%
  group_by(Year, ProgLanguage) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_data %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_data <- left_join(count_data, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_data, aes(x = factor(Year), y = Count, fill = ProgLanguage)) +
  geom_bar(stat = "identity") +
  labs(title = "Programming Language Usage by Year", x = "Year", y = "Count", fill = "Language") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
df_taxa <- df %>%
  mutate(Taxa = strsplit(as.character(Taxa), ", ")) %>%
  tidyr::unnest(Taxa)

# Count occurrences per year
count_data <- df_taxa %>%
  group_by(Year, Taxa) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_data %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_data <- left_join(count_data, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_data, aes(x = factor(Year), y = Count, fill = Taxa)) +
  geom_bar(stat = "identity") +
  labs(title = "Programming Language Usage by Year", x = "Year", y = "Count", fill = "Taxa") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
```{r}
df_analysis <- df %>%
  mutate(Analysis.Methods = strsplit(as.character(Analysis.Methods), ", ")) %>%
  tidyr::unnest(Analysis.Methods)

# Count occurrences per year
count_analysis <- df_analysis %>%
  group_by(Year, Analysis.Methods) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_analysis %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_analysis <- left_join(count_analysis, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_analysis, aes(x = factor(Year), y = Count, fill = Analysis.Methods)) +
  geom_bar(stat = "identity") +
  labs(title = "Analysis Methods Usage by Year", x = "Year", y = "Count", fill = "Analysis Methods") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
```{r}
df_tools <- df %>%
  mutate(Automation.Tools = strsplit(as.character(Automation.Tools), ", ")) %>%
  tidyr::unnest(Automation.Tools)

# Count occurrences per year
count_tools <- df_tools %>%
  group_by(Year, Automation.Tools) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_tools %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_tools <- left_join(count_tools, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_tools, aes(x = factor(Year), y = Count, fill = Automation.Tools)) +
  geom_bar(stat = "identity") +
  labs(title = "Automation Tools Usage by Year", x = "Year", y = "Count", fill = "Automation Tools") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
df_code_available <- df %>%
  mutate(Code.availability = strsplit(as.character(Code.availability), ", ")) %>%
  tidyr::unnest(Code.availability)

# Count occurrences per year
count_code_available <- df_code_available %>%
  group_by(Year, Code.availability) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_code_available %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_code_available <- left_join(count_code_available, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_code_available, aes(x = factor(Year), y = Count, fill = Code.availability)) +
  geom_bar(stat = "identity") +
  labs(title = "Code Availability Usage by Year", x = "Year", y = "Count", fill = "Code Available") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
df_data_available <- df %>%
  mutate(Data.Availability = strsplit(as.character(Data.Availability), ", ")) %>%
  tidyr::unnest(Data.Availability)

# Count occurrences per year
count_data_available <- df_data_available %>%
  group_by(Year, Data.Availability) %>%
  summarise(Count = n(), .groups = 'drop') %>%
  na.omit()

# Calculate percentages
total_count_per_year <- count_data_available %>%
  group_by(Year) %>%
  summarise(Total = sum(Count), .groups = 'drop')

count_data_available <- left_join(count_data_available, total_count_per_year, by = "Year") %>%
  mutate(Percentage = (Count / Total) * 100)

ggplot(count_data_available, aes(x = factor(Year), y = Count, fill = Data.Availability)) +
  geom_bar(stat = "identity") +
  labs(title = "Data Availability Usage by Year", x = "Year", y = "Count", fill = "Data Available") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
```{r}
df <- read.csv("tagged_literature.csv")
df %>%
  mutate(Automation.Tools = strsplit(as.character(Automation.Tools), ", ")) %>%
  tidyr::unnest(Automation.Tools) |>
  pull(Automation.Tools) |> sort() |> unique()
```
```{r}
df <- read.csv("tagged_literature.csv")
df %>%
  mutate(Analysis.Methods = strsplit(as.character(Analysis.Methods), ", ")) %>%
  tidyr::unnest(Analysis.Methods) |>
  pull(Analysis.Methods) |> sort() |> unique()
```

